<ion-header>
  <ion-toolbar>
    <ion-title>Sales Reports</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="exportToExcel()" [disabled]="isLoading">
        <ion-icon slot="icon-only" name="download-outline"></ion-icon>
      </ion-button>
      <ion-button (click)="exportToPDF()" [disabled]="isLoading">
        <ion-icon slot="icon-only" name="document-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Loading Spinner -->
  <div class="loading-container" *ngIf="isLoading">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Loading reports...</p>
  </div>

    <!-- Sales Overview Cards -->
    <ion-grid>
      <ion-row>
        <ion-col size="6" size-md="3">
          <ion-card>
            <ion-card-header>
              <ion-card-title>{{ formatCurrency(totalSales) }}</ion-card-title>
              <ion-card-subtitle>Total Sales</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>
        
        <ion-col size="6" size-md="3">
          <ion-card>
            <ion-card-header>
              <ion-card-title>{{ formatCurrency(avgTransaction) }}</ion-card-title>
              <ion-card-subtitle>Avg Transaction</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>
        
        <ion-col size="6" size-md="3">
          <ion-card>
            <ion-card-header>
              <ion-card-title>{{ transactions }}</ion-card-title>
              <ion-card-subtitle>Transactions</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>
        
        <ion-col size="6" size-md="3">
          <ion-card>
            <ion-card-header>
              <ion-card-title>{{ itemsSold }}</ion-card-title>
              <ion-card-subtitle>Items Sold</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>


    <!-- Top Products Section -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>Top Selling Products</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let product of topProducts; let i = index">
            <ion-label>
              <h2>#{{ i + 1 }} {{ product.name }}</h2>
              <p>{{ product.quantity }} units sold</p>
            </ion-label>
            <ion-note slot="end">{{ formatCurrency(product.total) }}</ion-note>
          </ion-item>
        </ion-list>
        
        <!-- Empty State -->
        <div class="empty-state" *ngIf="topProducts.length === 0">
          <ion-icon name="stats-chart-outline"></ion-icon>
          <h3>No sales data</h3>
          <p>Sales data will appear here after transactions</p>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Inventory Movement Section -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>Inventory Movement</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let movement of inventoryMovement">
            <ion-label>
              <h2>{{ movement.productName }}</h2>
              <p>Stock: {{ movement.currentStock }}</p>
            </ion-label>
            <ion-note slot="end" [color]="movement.change >= 0 ? 'success' : 'danger'">
              {{ movement.change >= 0 ? '+' : '' }}{{ movement.change }}
            </ion-note>
          </ion-item>
        </ion-list>
        
        <!-- Empty State -->
        <div class="empty-state" *ngIf="inventoryMovement.length === 0">
          <ion-icon name="cube-outline"></ion-icon>
          <h3>No inventory data</h3>
          <p>Inventory movements will appear here</p>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Recent Orders Section -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>Recent Orders</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let order of orders.slice(0, 5)">
            <ion-label>
              <h2>Order #{{ order.id?.substring(0, 8) }}</h2>
              <p>{{ order.createdAt | date:'medium' }}</p>
              <p>{{ order.items.length }} items</p>
            </ion-label>
            <ion-note slot="end">{{ formatCurrency(order.total) }}</ion-note>
          </ion-item>
        </ion-list>
        
        <!-- Empty State -->
        <div class="empty-state" *ngIf="orders.length === 0">
          <ion-icon name="receipt-outline"></ion-icon>
          <h3>No orders yet</h3>
          <p>Orders will appear here after checkout</p>
        </div>
      </ion-card-content>
    </ion-card>
</ion-content>